define(["backbone","jquery","./adjust_canvas","app/task/script","text!templates/loading.html"],function(e,t,n,r,i){var s=t.Deferred(),o=e.View.extend({id:"canvas",initialize:function(){this.activate=t.proxy(this.activate,this),this.render=t.proxy(this.render,this),t(window).on("orientationchange resize",t.proxy(this.adjustCanvas,this))},render:function(){return this.adjustCanvas(),this},activate:function(){var e=this,n=r.settings.canvas||{};return t(document).ready(function(){n.background&&t("body").css("background-color",n.background),n.canvasBackground&&e.$el.css("background-color",n.canvasBackground),n.borderColor&&e.$el.css("border-color",n.borderColor),n.borderWidth&&e.$el.css("border-width",n.borderWidth),n.css&&e.$el.css(n.css),e.$el.appendTo("body"),e.render(),s.resolve()}),this},loading:function(e){if(e.state()!="pending")return e;this.$el.html(i);var t=this.$(".meter span");return e.progress(function(e,n){t.width((n?e/n*100:0)+"%")})},empty:function(){this.$el.empty()},docReady:function(){return s},adjustCanvas:n});return new o});